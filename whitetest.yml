---
 - name: white test 
   hosts: all
   become: true 
   vars: 
    pkgs:
     - mariadb
     - php
   tasks: 
    - name : configure repository 
      yum_repository:
        name: baseos
        baseurl: http://classroom.example.com/content/rhel8.0/x86_64/dvd/BaseOS/
        description: Base OS Repo
        gpgcheck: yes
        enabled: yes
        key: http://classroom.example.com/content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release
        name: appstream
    - name: appsterm 
      yum_repository: 
         baseurl: http://classroom.example.com/content/rhel8.0/x86_64/dvd/AppStream/
         description:Appstrean Repo
         gpgcheck: yes
         enabled: yes 
         key: http://classroom.example.com/content/rhel8.0/x86_64/dvd/RPM-GPG-KEY-redhat-release
    - name: install packages 
      yum:
       name: "{{item}}"
       state: present
      when: inventory_hostname in groups['dev'] and inventory_hostname in groups['test']
      loop:
       "{{pkgs}}"
    - name: install  developement tools
      yum: 
       name: '@RPM Developement TOOLS'
       state: present
    - name: update all the packages
      yum:
       name: '*'
       state: latest
    - name:  configure    timesynt_ntp_servers
      vars: 
       - timesync_ntp_servers: 172.185.12.23
         iburst: yes
      roles:
       - timesync
    - name: https install  
      yum: 
       name: httpd
       state: present
    - name:  httpd enabled 
      service: 
       name: httpd
       state: started
       enabled: yes
    - name: firewalld 
      firewalld: 
       name: httpd 
       permanent: true 
       enabled: yes
    - name: create a index html
      templeate:
       - src : index.html.j2
       - dest: /www/var/  
    - name: call the roles  
      hosts: all
      role:
       - apacche 
    - name: management file 
      file:
       src: /webdev
       dest: /www/var/hrml/
       path: /webdev
       group: webdev   
       mode:775 
       state:link

  ## 9. Create a playbook webcontent.yml and it should run on dev group.
######i) Create a directory /devweb and it should be owned by devops group.
######ii) /devweb directory should have context type as "httpd"
######iii) Assign the permission for user=rwx,group=rwx,others=rx and group special
######permission should be applied to /devweb.
######iv) Create an index.html file under /devweb directory and the file should have
######the content "Developement".
######v) Link the /devweb directory to /var/www/html/devweb.     
    - name: confirgure files 
      file: 
       path: /webdev  
       owner: root
       group: devops
       setype: httpd_sys_content_t
       mode: u=rwx , g=rwx , o= rx
       state: directory

    - name: touch file index.html
      file: 
       path: /webdev/index.html
       state: touch
    - name: content 
      copy:
       content: "Developement"
       path: /webdev/index.html
    - name: symbolic link 
      file: 
       src: /devweb
       dest: /var/www/html/devweb
       state: link       
# ansible-navigator run webcontent.yml -m stdout
# curl http://servera.lab.example.com/devweb/ #(Verify the output)    


##  
##  
##  10. Collect hardware report using playbook in all nodes.
##  
##  i) Download hwreport.txt from the url
##  http://content.example.com/Rhce/hwreport.txt and save it under /root.
##  /root/hwreport.txt should have the content with node informations as key=value.
##  #hwreport
##  HOSTNAME=
##  MEMORY=
##  BIOS=
##  CPU=
##  DISK_SIZE_VDA=
##  DISK_SIZE_VDB=
##  ii) If there is no information it have to show "NONE".
##  iii) playbook name should be hwreport.yml.
##  ___________________________________________________________________________________
##  _______________________________________
##  Note: Copy the url "http://content.example.com/Rhce/hwreport.txt" and paste that on
##  new tab and verify the content in it.       





















##  ##in index.html.j2 
 #write this : welcome on "{{ansible_facts['fqdn']}}" on "{{ansible_facts['address']['default']}}"
# what we write it is a paybook now y need to  create the playbook using this role
   
#ansible-galaxy collection install -r /ansible/requirement.yml -p /home/devops/ansible/collections

    
   